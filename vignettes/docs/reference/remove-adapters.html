<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Remove left and right full and partial patterns — cutRseq • FastqCleaner</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">FastqCleaner</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Overview.html">An Introduction to FastqCleaner</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Remove left and right full and partial patterns</h1>
    </div>

    
    <p>This program can remove adapters and partial 
adapters from 3' and 5'. The adapters can be anchored or not. 
Two methods are available: one based on the exact matching 
of the sequence and the adapter, and a second in an error rate. 
When indels are allowed, the error rate consists in the edit distance. 
IUPAC simbols are allowed. The methods use the 
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingStartingAt</a></code> function
of the <span class="pkg">Biostrings</span> package to find matches. IUPAC symbols
are allowed in all the cases. The present function 
also removes partial adapters, without the need of additional steps
(for example, creating a padded adapter
with 'Ns', etc). 
A similar to what obtained with <code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/trimLRPatterns'>trimLRPatterns</a></code>
when the raw adaptor is passed, 
can be obtained with the option anchored = TRUE.
When several matches are found, the function removes the subsequence 
starting from the first match in cutRseq, and ending 
in the last one in cutLseq.</p>
    

    <pre class="usage"><span class='fu'>cutRseq</span>(<span class='no'>subject</span>, <span class='no'>Rpattern</span>, <span class='kw'>with.indels</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='st'>"subject"</span>,
<span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"exact"</span>, <span class='st'>"er"</span>), <span class='kw'>error_rate</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>anchored</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
<span class='kw'>ranges</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>min_match_flank</span> <span class='kw'>=</span> <span class='fl'>0L</span>, <span class='no'>...</span>)

<span class='fu'>cutLseq</span>(<span class='no'>subject</span>, <span class='no'>Lpattern</span>, <span class='kw'>with.indels</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='st'>"subject"</span>,
<span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"exact"</span>, <span class='st'>"er"</span>), <span class='kw'>error_rate</span> <span class='kw'>=</span> <span class='fl'>0.2</span>, <span class='kw'>anchored</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
<span class='kw'>ranges</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>min_match_flank</span> <span class='kw'>=</span> <span class='fl'>1L</span>, <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>subject</th>
      <td><p><code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/DNAString-class'>DNAString</a></code> or 
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/XStringSet-class'>DNAStringSet</a></code> object</p></td>
    </tr>
    <tr>
      <th>Rpattern</th>
      <td><p>3' pattern,
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/DNAString-class'>DNAString</a></code> object</p></td>
    </tr>
    <tr>
      <th>with.indels</th>
      <td><p>Allow indels? This is available only for er method.</p></td>
    </tr>
    <tr>
      <th>fixed</th>
      <td><p>Parameter passed to 
code<a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingStartingAt</a> and
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingEndingAt</a></code>  
Default 'subject',  ambiguities in the pattern only are interpreted 
as wildcard. See the argument fixed in 
code<a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingStartingAt</a> and
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingEndingAt</a></code></p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Method used for trimming. If 'exact' the metod is based
in the exact matching of the subsequences of the subject and  adapters 
If 'er' the metod is based on the eror-rate between the subsequences, 
allowing mismatches.</p></td>
    </tr>
    <tr>
      <th>error_rate</th>
      <td><p>Error rate (value in [0, 1] value for 'er' method. 
The error rate is the proportion of mismatches allowed between
the adapter and the aligned portion of the subject.
For a given adapter A, the number of allowed mismatches between each 
subsequence s of A and the subject is computed as error_rate * L_s,
where L_s is the length of the subsequence s.</p></td>
    </tr>
    <tr>
      <th>anchored</th>
      <td><p>Can the adapter or partial adapter be within 
the sequence? (dafault: anchored = TRUE)
or only in the terminal regions of the sequence (anchored; anchored = TRUE).
Default TRUE (trim only flanking regions).</p></td>
    </tr>
    <tr>
      <th>ranges</th>
      <td><p>return ranges? Default FALSE</p></td>
    </tr>
    <tr>
      <th>checks</th>
      <td><p>perform internal checks? Default TRUE</p></td>
    </tr>
    <tr>
      <th>min_match_flank</th>
      <td><p>Do not trim in flanks of the subject,
if a match has min_match_flank of less length. Default 1L 
(only trim with &gt;=2 coincidences in a flank match)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters passed to
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingStartingAt</a></code> and
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/lowlevel-matching'>isMatchingEndingAt</a></code></p></td>
    </tr>
    <tr>
      <th>Lpattern</th>
      <td><p>5' pattern,
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/DNAString-class'>DNAString</a></code> object</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Edited <code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/DNAString-class'>DNAString</a></code> or 
<code><a href='http://www.rdocumentation.org/packages/Biostrings/topics/XStringSet-class'>DNAStringSet</a></code> object</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'>library</span>(<span class='no'>Biostrings</span>)

<span class='no'>subject</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/Biostrings/topics/XStringSet-class'>DNAStringSet</a></span>(<span class='fu'>c</span>(<span class='st'>'ATCATGCCATCATGAT'</span>,
<span class='st'>'CATGATATTA'</span>, <span class='st'>'TCATG'</span>, <span class='st'>'AAAAAA'</span>, <span class='st'>'AGGTCATG'</span>))

<span class='no'>Lpattern</span> <span class='kw'>&lt;-</span> <span class='no'>Rpattern</span> <span class='kw'>&lt;-</span> <span class='st'>'TCATG'</span>

<span class='fu'>cutLseq</span>(<span class='no'>subject</span>, <span class='no'>Lpattern</span>)</div><div class='output co'>#&gt;   A DNAStringSet instance of length 5
#&gt;     width seq
#&gt; [1]    16 ATCATGCCATCATGAT
#&gt; [2]     6 ATATTA
#&gt; [3]     0 
#&gt; [4]     6 AAAAAA
#&gt; [5]     8 AGGTCATG</div><div class='input'><span class='fu'>cutLseq</span>(<span class='no'>subject</span>, <span class='no'>Lpattern</span>, <span class='kw'>ranges</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; IRanges object with 5 ranges and 0 metadata columns:
#&gt;           start       end     width
#&gt;       &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;
#&gt;   [1]         1        16        16
#&gt;   [2]         5        10         6
#&gt;   [3]         1         0         0
#&gt;   [4]         1         6         6
#&gt;   [5]         1         8         8</div><div class='input'><span class='fu'>cutRseq</span>(<span class='no'>subject</span>, <span class='no'>Rpattern</span>)</div><div class='output co'>#&gt;   A DNAStringSet instance of length 5
#&gt;     width seq
#&gt; [1]    15 ATCATGCCATCATGA
#&gt; [2]    10 CATGATATTA
#&gt; [3]     0 
#&gt; [4]     6 AAAAAA
#&gt; [5]     3 AGG</div><div class='input'>

<span class='fu'>cutLseq</span>(<span class='no'>subject</span>, <span class='no'>Lpattern</span>, <span class='kw'>anchored</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt;   A DNAStringSet instance of length 5
#&gt;     width seq
#&gt; [1]     2 AT
#&gt; [2]     6 ATATTA
#&gt; [3]     0 
#&gt; [4]     6 AAAAAA
#&gt; [5]     0 </div><div class='input'><span class='fu'>cutLseq</span>(<span class='no'>subject</span>, <span class='no'>Lpattern</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>'er'</span>, <span class='kw'>error_rate</span> <span class='kw'>=</span> <span class='fl'>0.2</span>)</div><div class='output co'>#&gt;   A DNAStringSet instance of length 5
#&gt;     width seq
#&gt; [1]    16 ATCATGCCATCATGAT
#&gt; [2]    10 CATGATATTA
#&gt; [3]     0 
#&gt; [4]     6 AAAAAA
#&gt; [5]     8 AGGTCATG</div><div class='input'><span class='fu'>cutLseq</span>(<span class='no'>subject</span>, <span class='no'>Lpattern</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>'er'</span>, <span class='kw'>error_rate</span> <span class='kw'>=</span> <span class='fl'>0.2</span>,
<span class='kw'>with.indels</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;   A DNAStringSet instance of length 5
#&gt;     width seq
#&gt; [1]    11 GCCATCATGAT
#&gt; [2]    10 CATGATATTA
#&gt; [3]     0 
#&gt; [4]     6 AAAAAA
#&gt; [5]     8 AGGTCATG</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Leandro Roser <a href='mailto:learoser@gmail.com'>learoser@gmail.com</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Leandro Roser, Fernán Agüero, Daniel Sánchez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
